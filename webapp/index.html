<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AyreliaSoftware Mini App</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
            overflow: hidden;
        }

        .welcome-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
        }

        #welcome-text {
            color: rgb(235, 5, 90);
            font-size: 2em;
            opacity: 0;
            animation: fadeIn 2s forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        .language-buttons {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            opacity: 0;
            transition: opacity 1s;
        }

        .language-buttons button {
            background: none;
            border: none;
            cursor: pointer;
        }

        .language-buttons img {
            width: 60px;
            height: 60px;
        }

        .hidden {
            display: none !important;
        }

        .main-app {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
            max-width: 768px; /* For tablet/mobile centering */
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #fff;
            border-bottom: 1px solid #ddd;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgb(235, 5, 90);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            overflow: hidden;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .settings-button {
            margin-left: 10px;
            background-color: #eee;
            border: none;
            font-size: 1em;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 20px;
        }

        .coins {
            display: flex;
            align-items: center;
            background-color: #eee;
            padding: 5px 10px;
            border-radius: 20px;
            cursor: pointer;
        }

        #coin-count {
            margin-right: 5px;
        }

        .coins img {
            width: 20px;
            height: 20px;
        }

        .content {
            flex: 1;
            padding: 20px;
            text-align: center;
            overflow-y: auto;
        }

        .bottom-nav {
            display: flex;
            justify-content: space-around;
            background-color: #fff;
            border-top: 1px solid #ddd;
            padding: 10px 0;
        }

        .nav-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            cursor: pointer;
            transition: transform 0.3s, color 0.3s;
        }

        .nav-button.active {
            color: red;
            transform: translateY(-5px);
        }

        .nav-button img {
            width: 30px;
            height: 30px;
            margin-bottom: 5px;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            max-width: 80%;
        }

        .tile-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .tile-row {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 10px;
        }

        .tile {
            width: 90%;
            height: 100px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .tile.small {
            width: 45%;
            height: 80px;
        }

        .tile img {
            width: 50px;
            height: 50px;
            margin-bottom: 5px;
        }

        .tile.disabled {
            background-color: #ccc;
            cursor: default;
        }

        .tile-description {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }

        .converter {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .converter input {
            width: 80%;
            margin: 5px 0;
            padding: 5px;
            text-align: center;
        }

        .converter label {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div id="welcome-screen" class="welcome-screen">
        <h1 id="welcome-text">AyreliaSoftware</h1>
        <div id="language-buttons" class="language-buttons hidden">
            <button id="ru-button"><img src="https://raw.githubusercontent.com/JaFaha/AyrSof-K3go-LDKA/refs/heads/main/webapp/icons/v1/icon_ru-lang_v1.png"></button>
            <button id="en-button"><img src="https://raw.githubusercontent.com/JaFaha/AyrSof-K3go-LDKA/refs/heads/main/webapp/icons/v1/icon_us-lang_v1.png"></button>
        </div>
    </div>

    <div id="main-app" class="main-app hidden">
        <header class="header">
            <div class="user-info">
                <div id="avatar" class="avatar"></div>
                <button id="settings-button" class="settings-button"></button>
            </div>
            <div id="coins-button" class="coins">
                <span id="coin-count">1337</span>
                <img src="https://raw.githubusercontent.com/JaFaha/AyrSof-K3go-LDKA/refs/heads/main/webapp/icons/v1/icon_coin_v1.png">
            </div>
        </header>

        <div id="content" class="content">
            <!-- Pages will be shown here -->
        </div>

        <nav class="bottom-nav">
            <button id="games-btn" class="nav-button">
                <img src="https://raw.githubusercontent.com/JaFaha/AyrSof-K3go-LDKA/refs/heads/main/webapp/icons/v2/icon_games_v2.png">
                <span>Games</span>
            </button>
            <button id="home-btn" class="nav-button">
                <img src="https://raw.githubusercontent.com/JaFaha/AyrSof-K3go-LDKA/refs/heads/main/webapp/icons/v2/icon_home_v2.png">
                <span>Home</span>
            </button>
            <button id="trade-btn" class="nav-button">
                <img src="https://raw.githubusercontent.com/JaFaha/AyrSof-K3go-LDKA/refs/heads/main/webapp/icons/v2/icon_trade_v2.png">
                <span>Trade</span>
            </button>
        </nav>

        <div id="settings-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Settings Soon...</h2>
                <button id="close-settings">Close</button>
            </div>
        </div>

        <div id="converter-modal" class="modal hidden">
            <div class="modal-content converter">
                <h2>Converter</h2>
                <label>Coins</label>
                <input type="number" id="coins-input" value="1337">
                <label>TON</label>
                <input type="number" id="ton-input" value="13.37">
                <p>100 Coins - 1 TON</p>
                <button id="close-converter">Close</button>
            </div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        const translations = {
            en: {
                home: "Home",
                games: "Games",
                trade: "Trade",
                settings: "Settings Soon...",
                close: "Close",
                comingSoon: "Coming soon...",
                converter: "Converter",
                bloggerCases: "Blogger Cases",
                bloggerCasesDesc: "Open cases and win prizes",
                plinko: "Plinko",
                plinkoDesc: "Drop balls and multiply your bets",
                plinkoClassic: "Plinko Classic",
                casesSub: "Cases",
                plinkoSub: "Plinko"
            },
            ru: {
                home: "Домой",
                games: "Игры",
                trade: "Торговля",
                settings: "Настройки Скоро...",
                close: "Закрыть",
                comingSoon: "Скоро...",
                converter: "Конвертер",
                bloggerCases: "Кейсы Блогеров",
                bloggerCasesDesc: "Открывайте кейсы и выигрывайте призы",
                plinko: "Плинко",
                plinkoDesc: "Бросайте шары и умножайте ставки",
                plinkoClassic: "Классический Плинко",
                casesSub: "Кейсы",
                plinkoSub: "Плинко"
            }
        };

        const tg = window.Telegram.WebApp;
        tg.ready();

        let lang = 'en'; // Default
        const user = tg.initDataUnsafe.user || { username: 'Ayrelia' };
        let currentPage = 'home';
        let coinCount = 1337;

        const welcomeScreen = document.getElementById('welcome-screen');
        const welcomeText = document.getElementById('welcome-text');
        const languageButtons = document.getElementById('language-buttons');
        const mainApp = document.getElementById('main-app');
        const avatar = document.getElementById('avatar');
        const settingsButton = document.getElementById('settings-button');
        const content = document.getElementById('content');
        const settingsModal = document.getElementById('settings-modal');
        const closeSettings = document.getElementById('close-settings');
        const converterModal = document.getElementById('converter-modal');
        const closeConverter = document.getElementById('close-converter');
        const coinsButton = document.getElementById('coins-button');
        const coinsInput = document.getElementById('coins-input');
        const tonInput = document.getElementById('ton-input');

        function initAvatar() {
            if (user.photo_url) {
                const img = document.createElement('img');
                img.src = user.photo_url;
                avatar.appendChild(img);
            } else {
                avatar.textContent = 'A';
            }
        }

        function setLanguage(selectedLang) {
            lang = selectedLang;
            updateTexts();
            welcomeScreen.classList.add('hidden');
            mainApp.classList.remove('hidden');
            showPage('home');
        }

        function updateTexts() {
            const t = translations[lang];
            document.querySelector('#home-btn span').textContent = t.home;
            document.querySelector('#games-btn span').textContent = t.games;
            document.querySelector('#trade-btn span').textContent = t.trade;
            settingsButton.textContent = user.username || 'Ayrelia';
            closeSettings.textContent = t.close;
            closeConverter.textContent = t.close;
            converterModal.querySelector('h2').textContent = t.converter;
        }

        function updateActiveButton() {
            document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
            if (currentPage === 'home') document.getElementById('home-btn').classList.add('active');
            else if (currentPage === 'games') document.getElementById('games-btn').classList.add('active');
            else if (currentPage === 'trade') document.getElementById('trade-btn').classList.add('active');
        }

        function showPage(page) {
            currentPage = page;
            updateActiveButton();
            const t = translations[lang];
            if (page === 'home' || page === 'trade') {
                content.innerHTML = `<h2>${t[page]}</h2>`;
            } else if (page === 'games') {
                content.innerHTML = `
                    <div class="tile-container">
                        <div class="tile" id="blogger-cases-tile">
                            <img src="https://raw.githubusercontent.com/JaFaha/Ayrelia-K3go-LDKA/refs/heads/main/webapp/icons/v2/icon_in-games_cases_main_v2.png">
                            <span>${t.bloggerCases}</span>
                        </div>
                        <p class="tile-description">${t.bloggerCasesDesc}</p>
                        <div class="tile" id="plinko-tile">
                            <img src="https://raw.githubusercontent.com/JaFaha/Ayrelia-K3go-LDKA/refs/heads/main/webapp/icons/v2/icon_in-games_plinko_main_v2.png">
                            <span>${t.plinko}</span>
                        </div>
                        <p class="tile-description">${t.plinkoDesc}</p>
                        <div class="tile disabled">
                            <span>${t.comingSoon}</span>
                        </div>
                    </div>
                `;
                document.getElementById('blogger-cases-tile').addEventListener('click', showCasesSub);
                document.getElementById('plinko-tile').addEventListener('click', showPlinkoSub);
            }
        }

        function showCasesSub() {
            const t = translations[lang];
            content.innerHTML = `
                <div class="tile-container">
                    <h3>${t.casesSub}</h3>
                    <div class="tile-row">
                        <div class="tile small">
                            <span>Case 1</span>
                        </div>
                        <div class="tile small">
                            <span>Case 2</span>
                        </div>
                    </div>
                    <div class="tile-row">
                        <div class="tile small disabled">
                            <span>${t.comingSoon}</span>
                        </div>
                        <div class="tile small disabled">
                            <span>${t.comingSoon}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function showPlinkoSub() {
            const t = translations[lang];
            content.innerHTML = `
                <div class="tile-container">
                    <h3>${t.plinkoSub}</h3>
                    <div class="tile">
                        <span>${t.plinkoClassic}</span>
                    </div>
                    <div class="tile disabled">
                        <span>${t.comingSoon}</span>
                    </div>
                </div>
            `;
        }

        document.getElementById('ru-button').addEventListener('click', () => setLanguage('ru'));
        document.getElementById('en-button').addEventListener('click', () => setLanguage('en'));

        document.getElementById('home-btn').addEventListener('click', () => showPage('home'));
        document.getElementById('games-btn').addEventListener('click', () => showPage('games'));
        document.getElementById('trade-btn').addEventListener('click', () => showPage('trade'));

        settingsButton.addEventListener('click', () => {
            settingsModal.querySelector('h2').textContent = translations[lang].settings;
            settingsModal.classList.remove('hidden');
        });

        closeSettings.addEventListener('click', () => settingsModal.classList.add('hidden'));

        coinsButton.addEventListener('click', () => {
            coinsInput.value = coinCount;
            tonInput.value = (coinCount / 100).toFixed(2);
            converterModal.classList.remove('hidden');
        });

        closeConverter.addEventListener('click', () => converterModal.classList.add('hidden'));

        coinsInput.addEventListener('input', () => {
            const coins = parseFloat(coinsInput.value) || 0;
            tonInput.value = (coins / 100).toFixed(2);
        });

        tonInput.addEventListener('input', () => {
            const ton = parseFloat(tonInput.value) || 0;
            coinsInput.value = (ton * 100).toFixed(0);
        });

        // Animation sequence
        welcomeText.addEventListener('animationend', () => {
            setTimeout(() => {
                welcomeText.style.transform = 'translateY(-50px)';
                languageButtons.classList.remove('hidden');
                languageButtons.style.opacity = 1;
            }, 1000);
        });

        initAvatar();
    </script>
</body>
</html>